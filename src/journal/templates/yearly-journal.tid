title: $:/plugins/mblackman/journal/ui/templates/yearly-journal
type: text/vnd.tiddlywiki

\whitespace trim

<$let 
  currentTiddler={{{ [<storyTiddler>!is[blank]else<currentTiddler>] }}}
  matchTitle={{{ [<storyTiddler>!is[blank]else<currentTiddler>] }}}
>

<<journal-nav "Yearly" "">>

<h3>âœ¨ Yearly Reflection</h3>

<div class="journal-section">
  <div class="journal-section-tight">
      <span class="journal-label">ğŸ† Big Wins</span>
      <$edit-text field="highlight" class="tc-edit-texteditor journal-input" placeholder="What were my big wins this year?" />
  </div>
  <div>
      <span class="journal-sublabel">Detailed Wins</span>
      <<journal-quick-add wins-log "Add a win...">>
      <$edit-text field="wins-log" class="tc-edit-texteditor journal-input" tag="textarea" min-height="80px" placeholder="..." />
  </div>
</div>

<div class="journal-section">
  <div class="journal-section-tight">
      <span class="journal-label">ğŸ“‰ Challenges</span>
      <$edit-text field="lowlight" class="tc-edit-texteditor journal-input" placeholder="What challenges did I face?" />
  </div>
  <div>
      <span class="journal-sublabel">Detailed Challenges</span>
      <<journal-quick-add challenges-log "Add a challenge...">>
      <$edit-text field="challenges-log" class="tc-edit-texteditor journal-input" tag="textarea" min-height="80px" placeholder="..." />
  </div>
</div>

<hr style="border: 0; border-top: 1px solid <<colour table-border>>;">

<h3>ğŸ“Š Habits Summary</h3>

<table style="width:100%; border-collapse: collapse;">
  <thead>
    <tr style="border-bottom: 2px solid <<colour table-border>>;">
      <th style="text-align:left; padding: 8px;">Month</th>
      <$list filter="[tag[$:/tags/Journal/Habit]!has[draft.of]sort[caption]]" variable="habitConfig">
        <th style="text-align:center; padding: 8px;"><$text text={{{ [<habitConfig>get[caption]] }}}/></th>
      </$list>
    </tr>
  </thead>
  <tbody>
    <$list filter="[tag[Monthly]tag[Journal]tag<matchTitle>sort[journal-date]]" variable="monthTiddler">
      <tr style="border-bottom: 1px solid <<colour table-border>>;">
        <td style="padding: 6px;"><$link to=<<monthTiddler>>><$text text={{{ [<monthTiddler>split[-]last[]] }}}/></$link></td>
        <$list filter="[tag[$:/tags/Journal/Habit]!has[draft.of]sort[caption]]" variable="habitConfig">
          <$let fieldName={{{ [<habitConfig>get[journal-field]] }}} habitType={{{ [<habitConfig>get[habit-type]] }}}>
            <td style="text-align:center; padding: 6px;">
              <$list filter="[<habitType>match[number]]" variable="ignore"><$text text={{{ [tag[Daily]tag[Journal]tag<monthTiddler>get<fieldName>sum[]] }}}/></$list>
              <$list filter="[<habitType>match[checkbox]]" variable="ignore"><$text text={{{ [tag[Daily]tag[Journal]tag<monthTiddler>get<fieldName>match[yes]count[]] }}}/></$list>
            </td>
          </$let>
        </$list>
      </tr>
    </$list>
    <tr style="font-weight: bold; background-color: <<colour table-header-background>>;">
      <td style="padding: 8px;">TOTALS</td>
      <$list filter="[tag[$:/tags/Journal/Habit]!has[draft.of]sort[caption]]" variable="habitConfig">
        <$let fieldName={{{ [<habitConfig>get[journal-field]] }}} habitType={{{ [<habitConfig>get[habit-type]] }}}>
          <td style="text-align:center; padding: 8px;">
            <$list filter="[<habitType>match[number]]" variable="ignore"><$text text={{{ [tag[Daily]tag[Journal]tag<matchTitle>get<fieldName>sum[]] }}}/></$list>
            <$list filter="[<habitType>match[checkbox]]" variable="ignore"><$text text={{{ [tag[Daily]tag[Journal]tag<matchTitle>get<fieldName>match[yes]count[]] }}}/></$list>
          </td>
        </$let>
      </$list>
    </tr>
  </tbody>
</table>

<h3>ğŸ¬ Media Consumption</h3>
<<media-consumption-summary "[tag[Daily]tag[Journal]tag<matchTitle>]">>

<h3>ï¸ Year in Review</h3>

<div class="journal-months-grid">
  <$list filter="[tag[Monthly]tag[Journal]tag<matchTitle>sort[journal-date]]">
    <$link class="journal-day-card">
      <span class="journal-day-card-name">Month</span>
      <span class="journal-day-card-date"><$text text={{{ [{!!title}split[-]last[]] }}}/></span>
    </$link>
  </$list>
</div>

</$let>